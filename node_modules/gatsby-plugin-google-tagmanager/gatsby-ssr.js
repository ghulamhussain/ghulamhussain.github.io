"use strict";

var _taggedTemplateLiteralLoose2 = require("babel-runtime/helpers/taggedTemplateLiteralLoose");

var _taggedTemplateLiteralLoose3 = _interopRequireDefault(_taggedTemplateLiteralLoose2);

var _templateObject = (0, _taggedTemplateLiteralLoose3.default)(["\n      &gtm_auth=", "&gtm_preview=", "&gtm_cookies_win=x\n    "], ["\n      &gtm_auth=", "&gtm_preview=", "&gtm_cookies_win=x\n    "]),
    _templateObject2 = (0, _taggedTemplateLiteralLoose3.default)(["\n            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n            'https://www.googletagmanager.com/gtm.js?id='+i+dl+'", "';f.parentNode.insertBefore(j,f);\n            })(window,document,'script','dataLayer', '", "');"], ["\n            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n            'https://www.googletagmanager.com/gtm.js?id='+i+dl+'", "';f.parentNode.insertBefore(j,f);\n            })(window,document,'script','dataLayer', '", "');"]),
    _templateObject3 = (0, _taggedTemplateLiteralLoose3.default)(["\n            <iframe\n              src=\"https://www.googletagmanager.com/ns.html?id=", "", "\"\n              height=\"0\"\n              width=\"0\"\n              style=\"display: none; visibility: hidden\"\n            ></iframe>"], ["\n            <iframe\n              src=\"https://www.googletagmanager.com/ns.html?id=", "", "\"\n              height=\"0\"\n              width=\"0\"\n              style=\"display: none; visibility: hidden\"\n            ></iframe>"]);

var _react = require("react");

var _react2 = _interopRequireDefault(_react);

var _commonTags = require("common-tags");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.onRenderBody = function (_ref, pluginOptions) {
  var setHeadComponents = _ref.setHeadComponents,
      setPreBodyComponents = _ref.setPreBodyComponents;

  if (process.env.NODE_ENV === "production" || pluginOptions.includeInDevelopment) {

    var environmentParamStr = pluginOptions.gtmAuth && pluginOptions.gtmPreview ? (0, _commonTags.oneLine)(_templateObject, pluginOptions.gtmAuth, pluginOptions.gtmPreview) : "";

    setHeadComponents([_react2.default.createElement("script", {
      key: "plugin-google-tagmanager",
      dangerouslySetInnerHTML: {
        __html: (0, _commonTags.stripIndent)(_templateObject2, environmentParamStr, pluginOptions.id)
      }
    })]);

    setPreBodyComponents([_react2.default.createElement("noscript", {
      key: "plugin-google-tagmanager",
      dangerouslySetInnerHTML: {
        __html: (0, _commonTags.stripIndent)(_templateObject3, pluginOptions.id, environmentParamStr)
      }
    })]);
  }
};